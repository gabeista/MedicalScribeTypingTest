<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Scribe Typing Test</title>
    <script>
        let startTime;
        let stopwatchInterval;
        let currentTest = "Medical Scribe Typing Test 1"; // Default to Test 1

        // Test passages
        const passages = {
            general: "The patient is a 45-year-old male presenting with chest pain...",
            medical: "A 32-year-old female presents with acute abdominal pain and nausea..."
        };

        // Load selected test passage
        function loadTest(testType) {
            currentTest = testType === "general" ? "Medical Scribe Typing Test 1" : "Medical Scribe Typing Test 2";
            document.getElementById("text-to-type").textContent = passages[testType];
            document.getElementById("user-input").value = ""; // Clear the input box
            document.getElementById("stopwatch").textContent = "0:00"; // Reset stopwatch
        }

        // Start timing
        function startStopwatch() {
            startTime = new Date();
            stopwatchInterval = setInterval(updateStopwatch, 1000);
        }

        function updateStopwatch() {
            const elapsedTime = Math.floor((new Date() - startTime) / 1000);
            document.getElementById("stopwatch").textContent = `${Math.floor(elapsedTime / 60)}:${elapsedTime % 60}`;
        }

        function stopTest() {
            clearInterval(stopwatchInterval);

            const originalText = document.getElementById("text-to-type").textContent.trim();
            let userTypedText = document.getElementById("user-input").value.trim();

            // Ensure same length for comparison
            userTypedText = userTypedText.substring(0, originalText.length);

            // Calculate time taken
            const timeTaken = (new Date() - startTime) / 1000;
            const wordsTyped = userTypedText.split(/\s+/).length;
            const wordsPerMinute = (wordsTyped / timeTaken) * 60;

            // Calculate accuracy
            const accuracy = calculateAccuracy(originalText, userTypedText);

            // Debugging Output
            console.log("Original Text:", originalText);
            console.log("User Typed Text:", userTypedText);
            console.log("Time Taken:", timeTaken.toFixed(2), "seconds");
            console.log("Words Per Minute (WPM):", wordsPerMinute.toFixed(2));
            console.log("Accuracy:", accuracy.toFixed(2), "%");

            // Display results
            document.getElementById("result").innerHTML = `
                <strong>Results:</strong><br>
                Typing Test Completed: ${currentTest}<br>
                Time Taken: ${timeTaken.toFixed(2)} seconds<br>
                Words Per Minute (WPM): ${wordsPerMinute.toFixed(2)}<br>
                Accuracy: ${accuracy.toFixed(2)}%<br>
                <strong>Feedback:</strong><br>
                Aim for at least 95% accuracy to ensure accurate documentation.
            `;
        }

        function calculateAccuracy(originalText, userTypedText) {
            let correctChars = 0;
            let totalChars = userTypedText.length;

            for (let i = 0; i < totalChars; i++) {
                if (userTypedText[i] === originalText[i]) {
                    correctChars++;
                }
            }

            return (correctChars / totalChars) * 100;
        }
    </script>
</head>
<body>

    <h2>Medical Scribe Typing Test</h2>
    <p>Select a test:</p>
    <button onclick="loadTest('general')">Test 1</button>
    <button onclick="loadTest('medical')">Test 2</button>

    <p id="text-to-type">Click a button to load a test passage.</p>
    <textarea id="user-input" placeholder="Start typing here..." onfocus="startStopwatch()"></textarea>

    <p>Time: <span id="stopwatch">0:00</span></p>
    <button onclick="stopTest()">Submit</button>

    <div id="result"></div>

</body>
</html>
